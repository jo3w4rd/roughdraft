<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],   j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-5V25JL6');</script>
    <script type="text/javascript">thisPackageMetaData = { name: "com.unity.entities", version: "0.17.0-preview.18", displayTitle:"Entities 0.17.0-preview.18", lang: "en" };</script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
  
    <title>Chunk component data | Entities | 0.17.0-preview.18 </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Chunk component data | Entities | 0.17.0-preview.18 ">
    <meta name="generator" content="docfx 2.51.0.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/version-switcher.css">
    <link rel="stylesheet" href="../styles/language-switcher.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    <meta property="unity:packageTitle" content="Entities | 0.17.0-preview.18">
    <meta property="docfx:rel" content="../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" class="">
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
        
        		<div class="back-to-unity-group">
        			<a class="back-to-unity" href="http://docs.unity3d.com/">docs.unity3d.com</a>
        		</div>
        
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items"></div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10" id="main_content">
          <div id="breadcrumb_placeholder"></div>
            <article class="content wrap" id="_content" data-uid="ecs-chunk-component-data">
<h1 id="chunk-component-data">Chunk component data</h1>

<p>Use chunk components to associate data with a specific <a class="xref" href="../api/Unity.Entities.ArchetypeChunk.html">chunk</a>.</p>
<p>Chunk components contain data that applies to all entities in a specific chunk. For example, if you have chunks of entities that represent 3D objects that are organized by proximity, you can use a chunk component to store a collective bounding box for them. chunk components use the interface type <a class="xref" href="../api/Unity.Entities.IComponentData.html">IComponentData</a>. </p>
<h2 id="add-and-set-the-values-of-a-chunk-component">Add and set the values of a chunk component</h2>
<p>Although chunk components can have values unique to an individual chunk, they are still part of the archetype of the entities in the chunk. Therefore, if you remove a chunk component from an entity, ECS moves that entity to a different chunk (possibly a new one). Likewise, if you add a chunk component to an entity, ECS moves that entity to a different chunk because its archetype changes; the addition of the chunk component does not affect the remaining entities in the original chunk. </p>
<p>If you use an entity in a chunk to change the value of a chunk component, it changes the value of the chunk component that is common to all the entities in that chunk. If you change the archetype of an entity so that it moves into a new chunk that has the same type of chunk component, then the existing value in the destination chunk is unaffected. </p>
<div class="NOTE"><h5>Note</h5><p>If the entity is moved to a newly created chunk, then ECS creates a new chunk component for that chunk and assigns its default value.</p>
</div>
<p>The main differences between working with chunk components and general-purpose components is that you use different functions to add, set, and remove them.  </p>
<p><strong>Relevant APIs</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Purpose</strong></th>
<th style="text-align:left"><strong>Function</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Declaration</td>
<td style="text-align:left"><a class="xref" href="../api/Unity.Entities.IComponentData.html">IComponentData</a></td>
</tr>
<tr>
<td style="text-align:left">&nbsp;</td>
<td style="text-align:left">&nbsp;</td>
</tr>
<tr>
<td style="text-align:left"><strong><a class="xref" href="../api/Unity.Entities.ArchetypeChunk.html">ArchetypeChunk methods</a></strong></td>
<td style="text-align:left">&nbsp;</td>
</tr>
<tr>
<td style="text-align:left">Read</td>
<td style="text-align:left"><a class="xref" href="../api/Unity.Entities.ArchetypeChunk.GetChunkComponentData.html">GetChunkComponentData&lt;T&gt;(ArchetypeChunkComponentType&lt;T&gt;)</a></td>
</tr>
<tr>
<td style="text-align:left">Check</td>
<td style="text-align:left"><a class="xref" href="../api/Unity.Entities.ArchetypeChunk.HasChunkComponent.html">HasChunkComponent&lt;T&gt;(ArchetypeChunkComponentType&lt;T&gt;)</a></td>
</tr>
<tr>
<td style="text-align:left">Write</td>
<td style="text-align:left"><a class="xref" href="../api/Unity.Entities.ArchetypeChunk.SetChunkComponentData.html">SetChunkComponentData&lt;T&gt;(ArchetypeChunkComponentType&lt;T&gt;, T)</a></td>
</tr>
<tr>
<td style="text-align:left">&nbsp;</td>
<td style="text-align:left">&nbsp;</td>
</tr>
<tr>
<td style="text-align:left"><strong><a class="xref" href="../api/Unity.Entities.EntityManager.html">EntityManager methods</a></strong></td>
<td style="text-align:left">&nbsp;</td>
</tr>
<tr>
<td style="text-align:left">Create</td>
<td style="text-align:left"><a class="xref" href="../api/Unity.Entities.EntityManager.AddChunkComponentData.html#Unity_Entities_EntityManager_AddChunkComponentData__1_Unity_Entities_Entity_">AddChunkComponentData&lt;T&gt;(Entity)</a></td>
</tr>
<tr>
<td style="text-align:left">Create</td>
<td style="text-align:left"><a class="xref" href="../api/Unity.Entities.EntityManager.AddChunkComponentData.html#Unity_Entities_EntityManager_AddChunkComponentData__1_Unity_Entities_EntityQuery___0_">AddChunkComponentData&lt;T&gt;(EntityQuery, T)</a></td>
</tr>
<tr>
<td style="text-align:left">Create</td>
<td style="text-align:left"><a class="xref" href="../api/Unity.Entities.EntityManager.AddComponents.html#Unity_Entities_EntityManager_AddComponents_Unity_Entities_Entity_Unity_Entities_ComponentTypes_">AddComponents(Entity,ComponentTypes)</a></td>
</tr>
<tr>
<td style="text-align:left">Get type info</td>
<td style="text-align:left"><a class="xref" href="../api/Unity.Entities.EntityManager.GetComponentTypeHandle.html">GetComponentTypeHandle</a></td>
</tr>
<tr>
<td style="text-align:left">Read</td>
<td style="text-align:left"><a class="xref" href="../api/Unity.Entities.EntityManager.GetChunkComponentData.html#Unity_Entities_EntityManager_GetChunkComponentData__1_Unity_Entities_ArchetypeChunk_">GetChunkComponentData&lt;T&gt;(ArchetypeChunk)</a></td>
</tr>
<tr>
<td style="text-align:left">Read</td>
<td style="text-align:left"><a class="xref" href="../api/Unity.Entities.EntityManager.GetChunkComponentData.html#Unity_Entities_EntityManager_GetChunkComponentData__1_Unity_Entities_Entity_">GetChunkComponentData&lt;T&gt;(Entity)</a></td>
</tr>
<tr>
<td style="text-align:left">Check</td>
<td style="text-align:left"><a class="xref" href="../api/Unity.Entities.EntityManager.HasChunkComponent.html">HasChunkComponent&lt;T&gt;(Entity)</a></td>
</tr>
<tr>
<td style="text-align:left">Delete</td>
<td style="text-align:left"><a class="xref" href="../api/Unity.Entities.EntityManager.RemoveChunkComponent.html#Unity_Entities_EntityManager_RemoveChunkComponent__1_Unity_Entities_Entity_">RemoveChunkComponent&lt;T&gt;(Entity)</a></td>
</tr>
<tr>
<td style="text-align:left">Delete</td>
<td style="text-align:left"><a class="xref" href="../api/Unity.Entities.EntityManager.RemoveChunkComponentData.html">RemoveChunkComponentData&lt;T&gt;(EntityQuery)</a></td>
</tr>
<tr>
<td style="text-align:left">Write</td>
<td style="text-align:left"><a class="xref" href="../api/Unity.Entities.EntityManager.SetChunkComponentData.html">EntityManager.SetChunkComponentData&lt;T&gt;(ArchetypeChunk, T)</a></td>
</tr>
</tbody>
</table>
<p><a name="declare"></a></p>
<h2 id="declaring-a-chunk-component">Declaring a chunk component</h2>
<p>Chunk components use the interface type <a class="xref" href="../api/Unity.Entities.IComponentData.html">IComponentData</a>.</p>
<pre><code class="lang-cs" name="declare-chunk-component">
public struct ChunkComponentA : IComponentData
{
    public float Value;
}
</code></pre><p><a name="create"></a></p>
<h2 id="creating-a-chunk-component">Creating a chunk component</h2>
<p>To add a chunk component directly, use an entity in the target chunk, or use an entity query that selects a group of target chunks. You cannot add chunk components inside a job, nor can they be added with an <a class="xref" href="../api/Unity.Entities.EntityCommandBuffer.html">EntityCommandBuffer</a>.</p>
<p>You can also include chunk components as part of  the <a class="xref" href="../api/Unity.Entities.EntityArchetype.html">EntityArchetype</a> or list of [ComponentType] objects that ECS uses to create entities. ECS creates the chunk components for each chunk and stores entities with that archetype. </p>
<p>Use <a class="xref" href="../api/Unity.Entities.ComponentType.ChunkComponent.html">ComponentType.ChunkComponent&lt;T&gt;</a> or [ComponentType.ChunkComponentReadOnly&lt;T&gt;] with these methods. Otherwise, ECS treats the component as a general-purpose component instead of a chunk component.</p>
<p><strong>With an entity in a chunk</strong></p>
<p>Given an entity in the target chunk, you can use the <a class="xref" href="../api/Unity.Entities.EntityManager.AddChunkComponentData.html#Unity_Entities_EntityManager_AddChunkComponentData__1_Unity_Entities_EntityQuery___0_">EntityManager.AddChunkComponentData&lt;T&gt;()</a> function to add a chunk component to the chunk:</p>
<pre><code class="lang-cs" name="em-snippet">
EntityManager.AddChunkComponentData&lt;ChunkComponentA&gt;(entity);
</code></pre><p>When you use this method, you cannot immediately set a value for the chunk component.</p>
<p><strong>With an <a class="xref" href="../api/Unity.Entities.EntityQuery.html">EntityQuery</a></strong></p>
<p>Given an entity query that selects all the chunks that you want to add a chunk component to, you can use the <a class="xref" href="../api/Unity.Entities.EntityManager.AddChunkComponentData.html#Unity_Entities_EntityManager_AddChunkComponentData__1_Unity_Entities_EntityQuery___0_">EntityManager.AddChunkComponentData&lt;T&gt;()</a> function to add and set the component:</p>
<pre><code class="lang-cs" name="desc-chunk-component">
EntityQueryDesc ChunksWithoutComponentADesc
    = new EntityQueryDesc()
{
    None = new ComponentType[]{
        ComponentType.ChunkComponent&lt;ChunkComponentA&gt;()
    }
};
EntityQuery ChunksWithoutChunkComponentA
    = GetEntityQuery(ChunksWithoutComponentADesc);

EntityManager.AddChunkComponentData&lt;ChunkComponentA&gt;(
    ChunksWithoutChunkComponentA,
    new ChunkComponentA() { Value = 4 });
</code></pre><p>When you use this method, you can set the same initial value for all of the new chunk components.</p>
<p><strong>With an <a class="xref" href="../api/Unity.Entities.EntityArchetype.html">EntityArchetype</a></strong></p>
<p>When you create entities with an archetype or a list of component types, include the chunk component types in the archetype:</p>
<pre><code class="lang-cs" name="archetype-chunk-component">
EntityArchetype ArchetypeWithChunkComponent
    = EntityManager.CreateArchetype(
    ComponentType.ChunkComponent(typeof(ChunkComponentA)),
    ComponentType.ReadWrite&lt;GeneralPurposeComponentA&gt;());
Entity newEntity
    = EntityManager.CreateEntity(ArchetypeWithChunkComponent);
</code></pre><p>or list of component types:</p>
<pre><code class="lang-cs" name="component-list-chunk-component">
ComponentType[] compTypes = {
    ComponentType.ChunkComponent&lt;ChunkComponentA&gt;(),
    ComponentType.ReadOnly&lt;GeneralPurposeComponentA&gt;()
};
Entity entity = EntityManager.CreateEntity(compTypes);
</code></pre><p>When you use these methods, the chunk components for new chunks that ECS creates as part of entity construction receive the default struct value. ECS does not change chunk components in existing chunks. See <a href="#update">Updating a chunk component</a> for how to set the chunk component value given a reference to an entity.</p>
<p><a name="read"></a></p>
<h2 id="reading-a-chunk-component">Reading a chunk component</h2>
<p>To read a chunk component, you can use the <a class="xref" href="../api/Unity.Entities.ArchetypeChunk.html">ArchetypeChunk</a> object that represents the chunk, or use an entity in the target chunk.</p>
<p><strong>With the ArchetypeChunk instance</strong></p>
<p>Given a chunk, you can use the <a class="xref" href="../api/Unity.Entities.EntityManager.GetChunkComponentData.html#Unity_Entities_EntityManager_GetChunkComponentData__1_Unity_Entities_ArchetypeChunk_">EntityManager.GetChunkComponentData&lt;T&gt;</a> function to read its chunk component. The following code iterates over all of the chunks that match a query and accesses a chunk component of type <code>ChunkComponentA</code>:</p>
<pre><code class="lang-cs" name="read-chunk-component">
NativeArray&lt;ArchetypeChunk&gt; chunks
    = ChunksWithChunkComponentA.CreateArchetypeChunkArray(
        Allocator.TempJob);

foreach (var chunk in chunks)
{
    var compValue =
     EntityManager.GetChunkComponentData&lt;ChunkComponentA&gt;(chunk);
    //..
}
chunks.Dispose();
</code></pre><p><strong>With an entity in a chunk</strong></p>
<p>Given an entity, you can access a chunk component in the chunk that contains the entity with <a class="xref" href="../api/Unity.Entities.EntityManager.GetChunkComponentData.html#Unity_Entities_EntityManager_GetChunkComponentData__1_Unity_Entities_ArchetypeChunk_">EntityManager.GetChunkComponentData&lt;T&gt;</a>:</p>
<pre><code class="lang-cs" name="read-entity-chunk-component">
if (EntityManager.HasChunkComponent&lt;ChunkComponentA&gt;(entity))
{
    ChunkComponentA chunkComponentValue =
     EntityManager.GetChunkComponentData&lt;ChunkComponentA&gt;(entity);
}
</code></pre><p><a name="update"></a></p>
<h2 id="updating-a-chunk-component">Updating a chunk component</h2>
<p>You can update a chunk component given a reference to the <a class="xref" href="../api/Unity.Entities.ArchetypeChunk.html">chunk</a> it belongs to. In an <code>IJobChunk</code> job, you can call <a class="xref" href="../api/Unity.Entities.ArchetypeChunk.SetChunkComponentData.html">ArchetypeChunk.SetChunkComponentData</a>. On the main thread, you can use the EntityManager version: <a class="xref" href="../api/Unity.Entities.EntityManager.SetChunkComponentData.html">EntityManager.SetChunkComponentData</a>. </p>
<div class="NOTE"><h5>Note</h5><p>You cannot access chunk components using SystemBase Entities.ForEach because you do not have access to the <code>ArchetypeChunk</code> object or the EntityManager.</p>
</div>
<p><strong>With the ArchetypeChunk instance</strong></p>
<p>To update a chunk component in a job, see <a href="#update">Reading and writing in a system</a>.</p>
<p>To update a chunk component on the main thread, use the EntityManager:</p>
<pre><code class="lang-cs" name="set-chunk-component">
EntityManager.SetChunkComponentData&lt;ChunkComponentA&gt;(
    chunk, new ChunkComponentA() { Value = 7 });
</code></pre><p><strong>With an Entity instance</strong></p>
<p>If you have an entity in the chunk rather than the chunk reference itself, you can also use the EntityManger to get the chunk that contains the entity:</p>
<div class="NOTE"><h5>Note</h5><p>If you only want to read a chunk component and not write to it, you should use <a class="xref" href="../api/Unity.Entities.ComponentType.ChunkComponentReadOnly.html">ComponentType.ChunkComponentReadOnly</a> when you define the entity query to avoid creating unnecessary job scheduling constraints.</p>
</div>
<p><a name="delete"></a></p>
<h2 id="deleting-a-chunk-component">Deleting a chunk component</h2>
<p>Use the <a class="xref" href="../api/Unity.Entities.EntityManager.RemoveChunkComponent.html">EntityManager.RemoveChunkComponent</a> functions to delete a chunk component. You can remove a chunk component given an entity in the target chunk or you can remove all of the chunk components of a given type from all chunks an entity query selects. </p>
<p>If you remove a chunk component from an individual entity, that entity moves to a different chunk because the archetype of the entity changes. The chunk keeps the unchanged chunk component as long as there are other entities that remain in the chunk. </p>
<p><a name="in-query"></a></p>
<h2 id="using-a-chunk-component-in-a-query">Using a chunk component in a query</h2>
<p>To use a chunk component in an entity query, you must use either the <a class="xref" href="../api/Unity.Entities.ComponentType.ChunkComponent.html">ComponentType.ChunkComponent&lt;T&gt;</a> or [ComponentType.ChunkComponentReadOnly&lt;T&gt;] functions to specify the type. Otherwise, ECS treats the component as a general-purpose component instead of a Chunk component.</p>
<p><strong>In an <a class="xref" href="../api/Unity.Entities.EntityQueryDesc.html">EntityQueryDesc</a></strong></p>
<p>You can use the following query description to create an entity query that selects all chunks, and entities in those chunks, that have a chunk component of type, <em>ChunkComponentA</em>:</p>
<pre><code class="lang-cs" name="use-chunk-component">
EntityQueryDesc ChunksWithChunkComponentADesc
    = new EntityQueryDesc()
{
    All = new ComponentType[] {
        ComponentType.ChunkComponent&lt;ChunkComponentA&gt;()
    }
};
</code></pre><p><a name="chunk-by-chunk"></a></p>
<h2 id="iterating-over-chunks-to-set-chunk-components">Iterating over chunks to set chunk components</h2>
<p>To iterate over all chunks for which you want to set a chunk component, you can create an entity query that selects the correct chunks and then use the EntityQuery object to get a list of the ArchetypeChunk instances as a native array. The ArchetypeChunk object allows you to write a new value to the chunk component. </p>
<pre><code class="lang-cs" name="full-chunk-example">
public class ChunkComponentExamples : SystemBase
{
    private EntityQuery ChunksWithChunkComponentA;
    protected override void OnCreate()
    {
        EntityQueryDesc ChunksWithComponentADesc = new EntityQueryDesc()
        {
            All = new ComponentType[] {
                ComponentType.ChunkComponent&lt;ChunkComponentA&gt;()
            }
        };
        ChunksWithChunkComponentA
            = GetEntityQuery(ChunksWithComponentADesc);
    }

    [BurstCompile]
    struct ChunkComponentCheckerJob : IJobEntityBatch
    {
        public ComponentTypeHandle&lt;ChunkComponentA&gt; ChunkComponentATypeHandle;
        public void Execute(ArchetypeChunk batchInChunk, int batchIndex)
        {
            var compValue
                = batchInChunk.GetChunkComponentData(ChunkComponentATypeHandle);
            //...
            var squared = compValue.Value * compValue.Value;
            batchInChunk.SetChunkComponentData(ChunkComponentATypeHandle,
                new ChunkComponentA() { Value = squared });
        }
    }

    protected override void OnUpdate()
    {
        var job = new ChunkComponentCheckerJob()
        {
            ChunkComponentATypeHandle
                = GetComponentTypeHandle&lt;ChunkComponentA&gt;()
        };
        this.Dependency
            = job.ScheduleParallel(ChunksWithChunkComponentA, 1,
                           this.Dependency);
    }
}
</code></pre><p>Note that if you need to read the components in a chunk to determine the proper value of a chunk component, you should use <a class="xref" href="../api/Unity.Entities.IJobEntityBatch.html">IJobEntityBatch</a>.  For example, the following code calculates the axis-aligned bounding box for all chunks containing entities that have LocalToWorld components:</p>
<pre><code class="lang-cs" name="aabb-chunk-component">
public struct ChunkAABB : IComponentData
{
    public AABB Value;
}

[UpdateInGroup(typeof(PresentationSystemGroup))]
[UpdateBefore(typeof(UpdateAABBSystem))]
public class AddAABBSystem : SystemBase
{
    EntityQuery queryWithoutChunkComponent;
    protected override void OnCreate()
    {
        queryWithoutChunkComponent
            = GetEntityQuery(new EntityQueryDesc()
        {
            All = new ComponentType[] {
                ComponentType.ReadOnly&lt;LocalToWorld&gt;()
            },
            None = new ComponentType[]{
                ComponentType.ChunkComponent&lt;ChunkAABB&gt;()
            }
        });
    }

    protected override void OnUpdate()
    {
        // This is a structural change and a sync point
        EntityManager.AddChunkComponentData&lt;ChunkAABB&gt;(
            queryWithoutChunkComponent,
            new ChunkAABB()
        );
    }
}

[UpdateInGroup(typeof(PresentationSystemGroup))]
public class UpdateAABBSystem : SystemBase
{
    EntityQuery queryWithChunkComponent;
    protected override void OnCreate()
    {
        queryWithChunkComponent
            = GetEntityQuery(new EntityQueryDesc()
        {
            All = new ComponentType[]
                  {
                      ComponentType.ReadOnly&lt;LocalToWorld&gt;(),
                      ComponentType.ChunkComponent&lt;ChunkAABB&gt;()
                  }
        });
    }

    [BurstCompile]
    struct AABBJob : IJobEntityBatch
    {
        [ReadOnly]
        public ComponentTypeHandle&lt;LocalToWorld&gt; LocalToWorldTypeHandleInfo;
        public ComponentTypeHandle&lt;ChunkAABB&gt; ChunkAabbTypeHandleInfo;
        public uint L2WChangeVersion;
        public void Execute(ArchetypeChunk batchInChunk, int batchIndex)
        {
            bool chunkHasChanges
                = batchInChunk.DidChange(LocalToWorldTypeHandleInfo,
                                  L2WChangeVersion);

            if (!chunkHasChanges)
                return; // early out if the chunk transforms haven&#39;t changed

            NativeArray&lt;LocalToWorld&gt; transforms
                = batchInChunk.GetNativeArray&lt;LocalToWorld&gt;(LocalToWorldTypeHandleInfo);
            UnityEngine.Bounds bounds = new UnityEngine.Bounds();
            bounds.center = transforms[0].Position;
            for (int i = 1; i &lt; transforms.Length; i++)
            {
                bounds.Encapsulate(transforms[i].Position);
            }
            batchInChunk.SetChunkComponentData(
                ChunkAabbTypeHandleInfo,
                new ChunkAABB() { Value = bounds.ToAABB() });
        }
    }

    protected override void OnUpdate()
    {
        var job = new AABBJob()
        {
            LocalToWorldTypeHandleInfo
                = GetComponentTypeHandle&lt;LocalToWorld&gt;(true),
            ChunkAabbTypeHandleInfo
                = GetComponentTypeHandle&lt;ChunkAABB&gt;(false),
            L2WChangeVersion = this.LastSystemVersion
        };
        this.Dependency
            = job.ScheduleParallel(queryWithChunkComponent, 1, this.Dependency);
    }
}
</code></pre></article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright © 2020 Unity Technologies<br>Generated by <strong>DocFX</strong></span> on Wednesday, October 28, 2020
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script type="text/javascript" src="../styles/metadata-collector.js"></script>
    <script type="text/javascript" src="../styles/version-switcher.js"></script>
    <script type="text/javascript" src="../styles/language-switcher.js"></script>
  </body>
</html>
