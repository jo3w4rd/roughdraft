<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Getting started </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Getting started ">
    <meta name="generator" content="docfx 2.40.7.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc">
    <meta property="docfx:tocrel" content="../toc">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../images/logo.png" alt="">
              </a>

            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
                
                <ul class="nav level1 navbar-nav">
                      <li>
                          <a href="../../manual/ecs_principles_and_vision.html" title="Manual">Manual</a>
                      </li>
                      <li>
                          <a href="../../api/Unity.Collections.html" title="Script Reference">Script Reference</a>
                      </li>
                </ul>    </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">
                  
                  <ul class="nav level1">
                    <li class="">
                      <a href="../ecs_principles_and_vision.html" title="The Unity Data-Oriented Tech Stack project" class="">The Unity Data-Oriented Tech Stack project</a>
                    </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="../getting_started/getting_started.html" title="Getting started" class="">Getting started</a>
                        
                        <ul class="nav level2">
                          <li class="active">
                            <a href="../getting_started/ecs_introduction.html" title="Entity Component Systems" class="active">Entity Component Systems</a>
                          </li>
                          <li class="">
                            <a href="../getting_started/hello_ecs.html" title="Hello (ECS) World" class="">Hello (ECS) World</a>
                          </li>
                          <li class="">
                            <a href="../getting_started/samples_overview.html" title="Samples" class="">Samples</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="../com.unity.entities/index.html" title="Unity Entity Component System" class="">Unity Entity Component System</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../com.unity.entities/index.html" title="Overview" class="">Overview</a>
                          </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../com.unity.entities/index.html" title="Core ECS" class="">Core ECS</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <span class="expand-stub"></span>
                                  <a href="../com.unity.entities/ecs_entities.html" title="Entities" class="">Entities</a>
                                    
                                    <ul class="nav level4">
                                      <li class="">
                                        <a href="../com.unity.entities/world.html" title="Worlds" class="">Worlds</a>
                                      </li>
                                    </ul>  </li>
                                <li class="">
                                  <span class="expand-stub"></span>
                                  <a href="../com.unity.entities/ecs_components.html" title="Components" class="">Components</a>
                                    
                                    <ul class="nav level4">
                                      <li class="">
                                        <a href="../com.unity.entities/component_data.html" title="General Purpose Components" class="">General Purpose Components</a>
                                      </li>
                                      <li class="">
                                        <a href="../com.unity.entities/shared_component_data.html" title="Shared Components" class="">Shared Components</a>
                                      </li>
                                      <li class="">
                                        <a href="../com.unity.entities/system_state_components.html" title="System State Components" class="">System State Components</a>
                                      </li>
                                      <li class="">
                                        <a href="../com.unity.entities/dynamic_buffers.html" title="Dynamic Buffer Components" class="">Dynamic Buffer Components</a>
                                      </li>
                                    </ul>  </li>
                                <li class="">
                                  <span class="expand-stub"></span>
                                  <a href="../com.unity.entities/ecs_systems.html" title="System" class="">System</a>
                                    
                                    <ul class="nav level4">
                                      <li class="">
                                        <a href="../com.unity.entities/component_system.html" title="Component Systems" class="">Component Systems</a>
                                      </li>
                                      <li class="">
                                        <a href="../com.unity.entities/job_component_system.html" title="Job Component Systems" class="">Job Component Systems</a>
                                      </li>
                                      <li class="">
                                        <a href="../com.unity.entities/entity_command_buffer.html" title="Entity Command Buffers" class="">Entity Command Buffers</a>
                                      </li>
                                      <li class="">
                                        <a href="../com.unity.entities/system_update_order.html" title="System Update Order" class="">System Update Order</a>
                                      </li>
                                    </ul>  </li>
                                <li class="">
                                  <span class="expand-stub"></span>
                                  <a href="../com.unity.entities/chunk_iteration.html" title="Accessing Entity Data" class="">Accessing Entity Data</a>
                                    
                                    <ul class="nav level4">
                                      <li class="">
                                        <a href="../com.unity.entities/entity_iteration_job.html" title="Using IJobProcessComponentData" class="">Using IJobProcessComponentData</a>
                                      </li>
                                      <li class="">
                                        <a href="../com.unity.entities/chunk_iteration_job.html" title="Using IJobChunk" class="">Using IJobChunk</a>
                                      </li>
                                      <li class="">
                                        <a href="../com.unity.entities/entity_iteration_foreach.html" title="Using ComponentSystem and ForEach" class="">Using ComponentSystem and ForEach</a>
                                      </li>
                                      <li class="">
                                        <a href="../com.unity.entities/manual_iteration.html" title="Manual iteration" class="">Manual iteration</a>
                                      </li>
                                      <li class="">
                                        <a href="../com.unity.entities/component_group.html" title="Component Groups" class="">Component Groups</a>
                                      </li>
                                    </ul>  </li>
                                <li class="">
                                  <a href="../com.unity.entities/version_numbers.html" title="Versions and Generations" class="">Versions and Generations</a>
                                </li>
                                <li class="">
                                  <a href="../com.unity.entities/ecs_burst.html" title="Using Burst" class="">Using Burst</a>
                                </li>
                                <li class="">
                                  <a href="../com.unity.entities/ecs_data_structures.html" title="Data Structures" class="">Data Structures</a>
                                </li>
                                <li class="">
                                  <span class="expand-stub"></span>
                                  <a href="../com.unity.entities/ecs_job_overview.html" title="Jobs in ECS" class="">Jobs in ECS</a>
                                    
                                    <ul class="nav level4">
                                      <li class="">
                                        <a href="../com.unity.entities/ecs_job_extensions.html" title="ECS Job System extensions" class="">ECS Job System extensions</a>
                                      </li>
                                    </ul>  </li>
                              </ul>  </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../com.unity.entities/index.html" title="Creating Gameplay" class="">Creating Gameplay</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="../com.unity.entities/transform_system.html" title="Transforms" class="">Transforms</a>
                                </li>
                                <li class="">
                                  <a href="../com.unity.entities/gp_rendering.html" title="Rendering" class="">Rendering</a>
                                </li>
                              </ul>  </li>
                        </ul>  </li>
                    <li class="">
                      <a href="../cheatsheet.html" title="Quick Reference" class="">Quick Reference</a>
                    </li>
                    <li class="">
                      <a href="../glossary.html" title="Glossary" class="">Glossary</a>
                    </li>
                    <li class="">
                      <a href="../resources.html" title="Learning Resources" class="">Learning Resources</a>
                    </li>
                  </ul>        </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="getting-started">Getting started</h1>

<p>Before you get started, consider how computer hardware has changed in the last several years. Although CPUs have continued to become more powerful, clock speeds have largely leveled off. Instead, the added power has come from increasing the number of processors on each chip. Because of this, you can no longer expect that an application will run faster on newer computers -- unless it has been designed to take advantage of multiple cores (rather than trying to run as fast as possible on a single core).</p>
<p>Another area that has received a lot of hardware design attention is the CPU cache. Although CPUs themselves are very fast, memory is slow. To combat this, computer hardware designs have added faster memory banks, called caches, and employed many tricks for keeping that memory full of the right data using techniques known as <a href="https://en.wikipedia.org/wiki/Cache_prefetching">prefetching</a>. </p>
<h2 id="what-are-we-trying-to-solve">What are we trying to solve?</h2>
<p>When making games with <strong>GameObject</strong>/<strong>MonoBehaviour</strong>, it is easy to write code that ends up being difficult to read, maintain and optimize. This is the result of a combination of factors: <a href="https://en.wikipedia.org/wiki/Object-oriented_programming">object-oriented model</a>, non-optimal machine code compiled from Mono, <a href="https://en.wikipedia.org/wiki/Garbage_collection_(computer_science)">garbage collection</a> and <a href="https://en.wikipedia.org/wiki/Thread_(computing)#Single_threading">single threaded</a> code.</p>
<h2 id="entity-component-system-to-the-rescue">Entity-component-system to the rescue</h2>
<p>An <a href="https://en.wikipedia.org/wiki/Entity%E2%80%93component%E2%80%93system">Entity-component-system</a> (ECS) is a way of writing code that focuses on the actual problems you are solving: the data and behavior that make up your game.</p>
<p>In addition to being a better way of approaching game programming for design reasons, using ECS puts you in an ideal position to leverage Unity&#39;s job system and Burst compiler, letting you take full advantage of today&#39;s multicore processors.</p>
<p>We have exposed Unity&#39;s native job system so that users can gain the benefits of <a href="https://en.wikipedia.org/wiki/Thread_(computing)">multithreaded</a> batch processing from within their ECS C# scripts. The native job system has built in safety features for detecting <a href="https://en.wikipedia.org/wiki/Race_condition">race conditions</a>.</p>
<p>However, we need to introduce a new way of thinking and coding to take full advantage of the job system.</p>
<h2 id="what-is-ecs">What is ECS?</h2>
<h3 id="monobehavior---a-dear-old-friend">MonoBehavior - A dear old friend</h3>
<p>MonoBehaviours contain both the data and the behaviour. This component will simply rotate the <strong>Transform</strong> component every frame.</p>
<pre><code class="lang-cs">    using UnityEngine;

    class Rotator : MonoBehaviour
    {
        // The data - editable in the inspector
        public float speed;

        // The behaviour - Reads the speed value from this component 
        // and changes the rotation of the Transform component.
        void Update()
        {
            transform.rotation *= Quaternion.AngleAxis(Time.deltaTime * speed, Vector3.up);
        }
    }
</code></pre><p>However MonoBehaviour inherits from a number of other classes; each containing their own set of data - none of which are in use by the script above. Therefore we have just wasted a bunch of memory for no good reason. So we need to think about what data we really need to optimize the code. </p>
<h3 id="componentsystem---a-step-into-a-new-era">ComponentSystem - A step into a new era</h3>
<p>In the new model the component only contains the data.</p>
<p>The <strong>ComponentSystem</strong> contains the behavior. One ComponentSystem is responsible for updating all GameObjects with a matching set of components.</p>
<pre><code class="lang-cs">using Unity.Entities;
using UnityEngine;

class Rotator : MonoBehaviour
{
    // The data - editable in the inspector
    public float Speed;
}

class RotatorSystem : ComponentSystem
{
    override protected void OnUpdate()
    {
        // We can immediately see a first optimization.
        // We know delta time is the same between all rotators,
        // so we can simply keep it in a local variable 
        // to get better performance.
        float deltaTime = Time.deltaTime;

        // ComponentSystem.ForEach
        // lets us efficiently iterate over all GameObjects
        // that have both a Transform &amp; Rotator components 
        ForEach((Transform transform, Rotator rotator) =&gt;
        {
            transform.rotation *= Quaternion.AngleAxis(rotator.Speed * deltaTime, Vector3.up);
        });
    }
}
</code></pre><h2 id="hybrid-ecs-using-componentsystem-to-work-with-existing-gameobject--components">Hybrid ECS: Using ComponentSystem to work with existing GameObject &amp; components</h2>
<p>There is a lot of existing code based on MonoBehaviour, GameObject and friends. We want to make it easy to work with existing GameObjects and existing components. But make it easy to transition one piece at a time to the ComponentSystem style approach.</p>
<p>In the example above you can see that we simply iterate over all components that contain both Rotator and Transform components.</p>
<h3 id="how-does-the-component-system-know-about-rotator-and-transform">How does the Component System know about Rotator and Transform?</h3>
<p>In order to iterate over components like in the Rotator example, those entities have to be known to the <strong>EntityManager</strong>.</p>
<p>ECS ships with the <strong>GameObjectEntity</strong> component. On <strong>OnEnable</strong>, the GameObjectEntity component creates an entity with all components on the GameObject. As a result the full GameObject and all its components are now iterable by ComponentSystems.</p>
<blockquote><p>Thus for the time being you must add a GameObjectEntity component on each GameObject that you want to be visible / iterable from the ComponentSystem.</p>
</blockquote>
<h3 id="how-does-the-componentsystem-get-created">How does the ComponentSystem get created?</h3>
<p>Unity automatically creates a default world on startup and populates it with all Component Systems in the project. Thus if you have a game object with the the necessary components and a <strong>GameObjectEntity</strong>, the System will automatically start executing with those components.</p>
<h3 id="what-does-this-mean-for-my-game">What does this mean for my game?</h3>
<p>It means that you can one by one, convert behavior from <strong>MonoBehaviour.Update</strong> methods into ComponentSystems. You can in fact keep all your data in a MonoBehaviour, and this is in fact a very simple way of starting the transition to ECS style code.</p>
<p>So your scene data remains in GameObjects &amp; components. You continue to use <a href="https://docs.unity3d.com/ScriptReference/Object.Instantiate.html">GameObject.Instantiate</a> to create instances etc.</p>
<p>You simply move the contents of your MonoBehaviour.Update into a <strong>ComponentSystem.OnUpdate</strong> method. The data is kept in the same MonoBehaviour or other components.</p>
<h4 id="what-you-get">What you get:</h4>
<ul>
<li>Separation of data &amp; behavior resulting in cleaner code</li>
<li>Systems operate on many objects in batch, avoiding per object virtual calls. It is easy to apply optimizations in batch. (See deltaTime optimization above.)</li>
<li>You can continue to use existing inspectors, editor tools etc</li>
</ul>
<h4 id="what-you-dont-get">What you don&#39;t get:</h4>
<ul>
<li>Instantiation time will not improve</li>
<li>Load time will not improve</li>
<li>Data is accessed randomly, no linear memory access guarantees</li>
<li>No multicore</li>
<li>No <a href="https://en.wikipedia.org/wiki/SIMD">SIMD</a></li>
</ul>
<p>So using ComponentSystem, GameObject and MonoBehaviour is a good first step to writing ECS code. It gives you some quick performance improvements, but it does not tap into the full range of performance benefits available.</p>
<h2 id="pure-ecs-full-on-performance---icomponentdata--jobs">Pure ECS: Full-on performance - IComponentData &amp; Jobs</h2>
<p>Achieving optimal performance is a strong motivation to use ECS for all game code. By optimal performance we mean that if you were to hand write all of your code using SIMD intrinsics (custom data layouts for each loop) then you would end up with similar performance to that which you get from writing simple ECS code.</p>
<p>The C# Job System does not support managed class types; only structs and <strong>NativeContainers</strong>. So only <strong>IComponentData</strong> can be safely accessed in a C# Job.</p>
<p>The EntityManager makes hard guarantees about <a href="https://en.wikipedia.org/wiki/Flat_memory_model">linear memory layout</a> of the component data. This is an important part of the great performance you can achieve with C# jobs using IComponentData.</p>
<pre><code class="lang-cs">using System;
using Unity.Entities;

// The rotation speed component simply stores the Speed value
[Serializable]
public struct RotationSpeed : IComponentData
{
    public float Value;
}

// This wrapper component is currently necessary to add ComponentData to GameObjects.
// In the future we want to make this wrapper component automatic.
public class RotationSpeedComponent : ComponentDataWrapper&lt;RotationSpeed&gt; { } 
</code></pre><pre><code class="lang-cs">using Unity.Collections;
using Unity.Entities;
using Unity.Jobs;
using Unity.Burst;
using Unity.Mathematics;
using Unity.Transforms;
using UnityEngine;

// Using IJobProcessComponentData to iterate over all entities matching the required component types.
// Processing of entities happens in parallel. The main thread only schedules jobs.
public class RotationSpeedSystem : JobComponentSystem
{
    // IJobProcessComponentData is a simple way of iterating over all entities given the set of required compoenent types.
    // By marking the job Burst compile we get significantly better codegen and thus much faster code at runtime.
    [BurstCompile]
    struct RotationSpeedRotation : IJobProcessComponentData&lt;Rotation, RotationSpeed&gt;
    {
        public float dt;

        public void Execute(ref Rotation rotation, [ReadOnly]ref RotationSpeed speed)
        {
            rotation.Value = math.mul(math.normalize(rotation.Value), quaternion.axisAngle(math.up(), speed.Value * dt));
        }
    }

    // We derive from JobComponentSystem, as a result the system proviides us 
    // the required dependencies for our jobs automatically.
    //
    // IJobProcessComponentData declares that it will read RotationSpeed and write to Rotation.
    //
    // Because it is declared the JobComponentSystem can give us a Job dependency, which contains all previously scheduled
    // jobs that write to any Rotation or RotationSpeed.
    // We also have to return the dependency so that any job we schedule 
    // will get registered against the types for the next System that might run.
    // This approach means:
    // * No waiting on main thread, just scheduling jobs with dependencies (Jobs only start when dependencies have completed)
    // * Dependencies are figured out automatically for us, so we can write modular multithreaded code
    protected override JobHandle OnUpdate(JobHandle inputDeps)
    {
        var job = new RotationSpeedRotation() { dt = Time.deltaTime };
        return job.Schedule(this, inputDeps);
    } 
}
</code></pre></article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/Unity-Technologies/dots/blob/organize-docs/doc-src/manual/getting_started/ecs_introduction.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            &nbsp;
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
