<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],   j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-MC35ML');</script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
  
    <title>Spatial Mapping best practices | Unity Technologies Developer Guide </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Spatial Mapping best practices | Unity Technologies Developer Guide ">
    <meta name="generator" content="docfx 2.40.7.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" class="manual">
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MC35ML" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
        
        		<div class="back-to-unity-group">
        			<a class="back-to-unity" href="http://docs.unity3d.com/">docs.unity3d.com</a>
        		</div>
        
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items"></div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="spatial-mapping-best-practices">Spatial Mapping best practices</h1>

<p>Because of the volume of data that can be generated by Spatial Mapping, and the effect on speed and performance of generating that data, there are many issues to consider when using the low-level API. </p>
<p>If you don&#39;t carefully plan your application&#39;s use of Spatial Mapping, your application&#39;s speed and performance can be poor. Below are some potential issues that Spatial Mapping can create, and best practice advice on how to work around them.</p>
<h2 id="issue-generating-collision-data-is-very-slow">Issue: Generating collision data is very slow</h2>
<p>Generating collision data uses most of the CPU computation when generating Spatial Mapping data. Requesting collision data that isn&#39;t going to be used unnecessarily ties up CPU resources and reduces battery life.</p>
<h3 id="best-practice-solution">Best practice solution:</h3>
<ul>
<li>Request collision data only where necessary. Avoiding collision data requests when they are not needed decreases the latency for other Spatial Mapping requests, and prolongs battery life.</li>
<li>Request only those <strong>Surfaces</strong> that are most important. Use a <strong>Surface</strong>&#39;s update time and bounding boxes to prioritize data requests.</li>
</ul>
<h2 id="issue-high-triangle-densities-generate-a-lot-of-geometry">Issue: High triangle densities generate a lot of geometry</h2>
<p>You can specify high values of <strong>trianglesPerCubicMeter</strong> in the <a href="ScriptRef:XR.WSA.SurfaceData.html">SurfaceData struct</a> when requesting <strong>Surface</strong> data through <a href="ScriptRef:XR.WSA.SurfaceObserver.RequestMeshAsync">RequestMeshAsync</a>. This generates a very large amount of geometry, especially in spaces with a lot of objects such as a cluttered office. Large amounts of geometry increase data generation latency and memory usage. In addition, higher Mesh densities can make run-time systems such as rendering and physics run more slowly.</p>
<h3 id="best-practice-solution-1">Best practice solution:</h3>
<ul>
<li>Ask for the minimum resolution of Spatial Mapping data required. Asking for lower resolutions of generated Meshes results in less CPU time spent serving requests. This reduces power consumption, increases battery life, and reduces the latency of Mesh data delivery. Lower resolution Meshes also have fewer negative effects on run-time performance and are less resource-intensive on memory requirements. This is especially true for the physics runtime, which expects low complexity geometry.</li>
</ul>
<h2 id="issue-queuing-too-many-mesh-requests-result-in-doing-unnecessary-work">Issue: Queuing too many mesh requests result in doing unnecessary work</h2>
<p><a href="ScriptRef:XR.WSA.SurfaceObserver.html">SurfaceObservers</a> report all added, updated, and removed <strong>Surfaces</strong> within their volume when <a href="ScriptRef:XR.WSA.SurfaceObserver.Update.html">Update</a> is called.  </p>
<p>Adding the total list of changed <strong>Surfaces</strong> to the work queue can result in <strong>Surfaces</strong> remaining in the work queue after they have been removed by the system. <strong>Surfaces</strong> still in the work queue after they have been removed still take up CPU time moving through the system, but do not generate any mMsh data. This increases the latency of any waiting requests.</p>
<h3 id="best-practice-solution-2">Best practice solution:</h3>
<ul>
<li>Limit the number of <strong>Surfaces</strong> in the work queue when possible. Given the long latencies associated with the Mesh work queue, keep only a single <code>RequestMeshAsync</code> in use at a time. Applications can use a <strong>Surface</strong>&#39;s reported update time and bounds to prioritize <code>RequestMeshAsync</code> calls. </li>
<li>Prioritize <strong>Surface</strong> data requests so that your application gets the most important data first.  Examples of this include:<ul>
<li>Prioritize new <strong>Surfaces</strong> over updates to existing ones.</li>
<li>Prioritize near <strong>Surfaces</strong> over more distant ones.</li>
</ul>
</li>
</ul>
<h2 id="issue-overlapping-or-adjacent-surfaceobservers-report-the-same-mesh-resulting-in-duplicate-requestmeshasync-calls">Issue: Overlapping or adjacent SurfaceObservers report the same Mesh, resulting in duplicate RequestMeshAsync calls</h2>
<p>Each <a href="ScriptRef:XR.WSA.SurfaceObserver.html">SurfaceObserver</a> reports changes for all <strong>Surfaces</strong> that overlap its volume. A <strong>Surface</strong> can overlap multiple <strong>SurfaceObserver</strong> volumes if those volumes are close, so your application code might request the same <strong>Surfaces</strong> multiple times.</p>
<h3 id="best-practice-solution-3">Best practice solution:</h3>
<ul>
<li>Use a single work submit queue across all <a href="ScriptRef:XR.WSA.SurfaceObserver.html">SurfaceObservers</a>.
Often, a single <strong>SurfaceObserver</strong> is enough, as using just one avoids application complexity.
However, there are several advanced use cases for <strong>Spatial Mapping</strong> that require multiple <strong>SurfaceObservers</strong>. In these cases, use a single queue across all <strong>SurfaceObservers</strong> to uniquely prioritize Mesh requests.</li>
<li>Use a single <strong>SurfaceObserver</strong> if your application does not require more complexity.</li>
</ul>
<h2 id="issue-updating-a-surfaceobserver-generates-no-onsurfacechanged-callbacks">Issue: Updating a SurfaceObserver generates no onSurfaceChanged callbacks</h2>
<p>This common issue is typically due to one or more set-up issues.</p>
<h3 id="best-practice-solution-4">Best practice solution:</h3>
<ul>
<li>Ensure that you set a valid volume on your <strong>SurfaceObserver</strong> through a function like <a href="ScriptRef:XR.WSA.SurfaceObserver.SetVolumeAsAxisAlignedBox.html">SetVolumeAsAxisAlignedBox</a>.</li>
<li>Ensure that you&#39;ve checked <strong>Spatial Perception</strong> from the <strong>Publishing Settings</strong> section of <strong>Player Settings</strong>.</li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright © 2019 Unity Technologies<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
